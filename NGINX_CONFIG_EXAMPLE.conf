# Example Nginx Configuration for Consumables App
# This is a SAFE configuration that won't interfere with Zabbix
# 
# IMPORTANT: 
# - This creates a NEW server block, doesn't modify Zabbix config
# - Container runs on port 3000, Zabbix uses 80/443 via Nginx
# - Always run: sudo nginx -t before reloading!

# Option 1: Separate Domain/Subdomain
server {
    listen 80;
    server_name consumables.yourdomain.com;  # Change to your domain or IP

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    proxy_connect_timeout 60s;
    proxy_send_timeout 60s;
    proxy_read_timeout 60s;
}

# Option 2: Subdirectory (if you want /consumables path)
# Add this to your existing server block (the one with Zabbix)
# DO NOT replace the entire server block, just add this location block:

# location /consumables {
#     proxy_pass http://localhost:3000;
#     proxy_http_version 1.1;
#     proxy_set_header Upgrade $http_upgrade;
#     proxy_set_header Connection 'upgrade';
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     proxy_set_header X-Forwarded-Proto $scheme;
#     proxy_cache_bypass $http_upgrade;
#     
#     # Rewrite API paths to work with subdirectory
#     rewrite ^/consumables/api/(.*) /api/$1 break;
#     rewrite ^/consumables/(.*) /$1 break;
# }

